{% extends "base.html" %}
{% load static %}

{% block content %}

<!-- Alert Messages -->
{% if messages %}
{% for message in messages %}
<div class="alert alert-{{ message.tags }}">
    {{ message }}
</div>
{% endfor %}
{% endif %}

<!-- User's Own Profile -->
{% if own_profile %}
<div class="container">
    <h2>My Profile</h2>
    <p>Welcome, {{ user.username }}!</p>
    {% if profile.featured_image %}
    <img src="{{ profile.featured_image.url }}" alt="Profile Image">
    {% else %}
    <img src="{% static 'images/profile-default-image.jpg' %}"
        alt="Default Profile Image">
    {% endif %}
    <p>Email: {{ user.email }}</p>
    <p>About Me: {{ user.profile.about_me }}</p>
    {% if profile.city or profile.state %}
    <p>Location: {{ profile.city }}, {{ profile.state }}</p>
    {% else %}
    <p>Location: Not Set</p>
    {% endif %}

    <!-- User's Products -->
    <h3>My Products</h3>
    {% for product in user.products.all %}
    <div>
        <a href="{% url 'product-detail' product.slug %}">
            {{ product.title }}</a> - {{ product.description }}
    </div>
    {% empty %}
    <p>You have not added any products yet.</p>
    {% endfor %}

    <!-- User's Wishlist -->
    <h3><a href="{% url 'wishlist-view' %}">
            My Wishlist:</a></h3>
    {% for item in wishlist_items %}
    <a href="{% url 'product-detail' slug=item.product.slug %}">
        {{ item.product.title }}</a> - {{ item.product.description }}
    </a>
    {% empty %}
    <p>Your wishlist is empty.</p>
    {% endfor %}
    </div>

    <!-- Profile Controls -->
    <a href="{% url 'edit-profile' %}" class="btn btn-primary">Edit Profile</a>
    <a href="{% url 'delete-account' %}" class="btn btn-danger">Delete
        Account</a>
    <a href="{% url 'logout' %}" class="btn btn-secondary">Logout</a>
</div>

<!-- Seller's Profile -->
{% else %}
<div class="container">
    <h2>Viewing {{ profile_user.username }}'s profile.</h2>
    <img src="{% static 'users/images/default-profile-image.webp' %}"
        alt="Profile image">
    <p>Email: {{ profile_user.email }}</p>
    <p>About Me: {{ profile_user.about_me }}</p>

    <!-- to be edited -->
    {% if profile_user.city %}
    <p>Location: {{ profile_user.city }}, {{ profile_user.state }}</p>
    {% else %}
    <p>Location: Not set</p>
    {% endif %}

    <!-- Seller's Products -->
    <h3>{{ profile_user.username }}'s Products</h3>
    {% for product in profile_user.products.all %}
    <div>
        <a href="{% url 'product-detail' product.slug %}">
            {{ product.title }}</a> - {{ product.description }}
    </div>
    {% empty %}
    <p>They have not added any products yet.</p>
    {% endfor %}

    <!-- Seller's Wishlist -->
    <h3>{{ profile_user.username }}'s Wishlist</h3>
    {% for item in wishlist_items %}
    <div>
        <a href="{% url 'product-detail' slug=item.product.slug %}">
            {{ item.product.title }}</a> - {{ item.product.description }}
    </div>
    {% empty %}
    <p>This user's wishlist is empty.</p>
    {% endfor %}
</div>
{% endif %}

{% endblock %}
